@import 'variables';

/* ==== Базовий лейаут ==== */
app-poll-stepper {
  /* кастомна змінна висоти футера (під кнопки/падінги) */
  --footer-h: 76px;

  display: flex;
  flex-direction: column;
  min-height: 100vh;
  height: 100%;
  padding-bottom: env(safe-area-inset-bottom); /* iOS safe area */

  background:
    radial-gradient(800px circle at 80% 0%, rgba($hs-primary, 0.3), transparent),
    radial-gradient(600px circle at 20% 100%, rgba($hs-accend, 0.3), transparent),
    radial-gradient(1000px circle at 50% 50%, rgba(0, 0, 0, 0.08), transparent),
    #ffffff;

  .poll-app {
    display: flex;
    flex-direction: column;
    min-height: 100%;
  }

  /* ==== Header ==== */
  .app-header {
    position: sticky; top: 0; z-index: 2;
    padding: 16px;
    background: #fff;
    border-bottom: 1px solid $hs-secondary-grey-01;

    .brand {
      display: flex; align-items: center; gap: 8px; margin-bottom: 12px;

      .dot { width: 10px; height: 10px; border-radius: 50%; background: $hs-primary; box-shadow: 0 0 8px rgba($hs-primary, 0.5); }
      .brand-name { font-weight: 700; font-size: 18px; color: $hs-black; }
    }
  }

  /* ==== Progress ==== */
  .progress {
    width: 100%; height: 6px; background: $hs-secondary-grey-00; border-radius: 999px; overflow: hidden;
    .bar { height: 100%; background: $hs-primary; transition: width 0.3s ease; }
  }

  /* ==== Main container зі скролом ==== */
  .poll-stepper-container {
    /* віднімаємо висоту футера + safe-area, щоб футер не перекривав контент */
    min-height: calc(100vh - var(--footer-h) - env(safe-area-inset-bottom));
    flex: 1;
    overflow-y: auto; /* скрол, якщо не влазить */
    -webkit-overflow-scrolling: touch; /* плавний скрол на iOS */
    padding: 24px 16px;
    display: flex; flex-direction: column; align-items: center; gap: 16px;
  }

  .poll-stepper-field-container {
    width: 100%; max-width: 540px;
    background: $hs-neutrals-light;
    border: 1px solid $hs-secondary-grey-01;
    border-radius: 20px;
    box-shadow: 0 8px 30px rgba($hs-black, 0.05);
    padding: 20px; min-height: 220px;
    animation: fadeInStep 250ms ease;
  }

  /* Екран подяки */
  .poll-stepper-field-container.thankyou {
    padding: 32px 24px; text-align: center;
    .poll-stepper-question { font-size: 18px; font-weight: 700; color: $hs-primary; line-height: 1.5; margin: 0; }
  }

  @keyframes fadeInStep {
    from { opacity: 0; transform: translateY(8px); }
    to   { opacity: 1; transform: translateY(0); }
  }

  /* ==== Bottom nav (footer) ==== */
  .poll-stepper-navigation {
    /* sticky гарантує, що він прилипає над панеллю Safari */
    position: sticky; bottom: 0; z-index: 3;
    left: 0; right: 0;

    display: grid;
    grid-template-columns: 1fr auto 1fr;
    align-items: center; gap: 12px;

    /* враховуємо safe-area iOS */
    padding: 12px 16px calc(env(safe-area-inset-bottom) + 12px);
    background: #fff;
    border-top: 1px solid $hs-secondary-grey-01;
    box-shadow: 0 -4px 12px rgba($hs-black, 0.05);

    /* синхронізуємо реальну висоту футера зі змінною */
    /* (щоб формула вище правильно віднімала висоту) */
    &::after { content: ""; position: absolute; visibility: hidden; height: var(--footer-h); }

    button {
      height: 48px; border-radius: 999px;
      font-weight: 600; font-size: 14px; letter-spacing: 0.3px;
      border: none; cursor: pointer;
      transition: background-color 0.2s ease, transform 0.1s ease;

      &:disabled { background-color: $hs-secondary-grey-01; color: $text-silver; cursor: not-allowed; }
      &:active:not(:disabled) { transform: scale(0.98); }
    }

    .ghost {
      background: transparent; border: 1px solid $hs-secondary-grey-01; color: $hs-black;
      &:hover:not(:disabled) { background: $hs-secondary-grey-00; }
    }

    .primary {
      width: 100%; background: $hs-accend-gradient; color: #fff;
      box-shadow: 0 4px 12px rgba($hs-accend, 0.3);
      &:hover:not(:disabled) { box-shadow: 0 6px 14px rgba($hs-accend, 0.4); }
    }

    .steps-indicator {
      display: flex; align-items: center; gap: 8px;
      span {
        width: 8px; height: 8px; border-radius: 50%; background: $hs-secondary-grey-02;
        transition: transform 0.2s ease, background-color 0.2s ease;
        &.active { background: $hs-primary; transform: scale(1.3); box-shadow: 0 0 8px rgba($hs-primary, 0.4); }
      }
    }
  }
}
